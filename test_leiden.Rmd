---
title: "R Notebook"
output: html_notebook
---
 

```{r}
library(Rcpp)
library(igraph)
library(Matrix)
source("r/graphFromFitHIC.R")
update.packages("Rcpp")
setwd("C:/Users/bbessell/Projects/GitHub/AluNet")
Sys.setenv(PKG_CXXFLAGS = "-std=c++17")
Sys.which("make")
Sys.which("g++")
#sourceCpp("rcpp/compile_test.cpp", verbose = TRUE, rebuild = TRUE)
sourceCpp("rcpp/GraphUtils.cpp", verbose = F, rebuild = TRUE)
```

```{r}
sourceCpp("rcpp/Leiden.cpp", verbose = F, rebuild = TRUE)
```

```{r}
#g_list <- graphFromFitHIC("data/hic_test.txt", "chr1")
g_list <- graphFromFitHIC("data/hic_test_10k.txt", "chr1")
#g_list <- graphFromFitHIC("data/GSE148434_NS_all.5kb.1e-2.FitHiC.all.txt", "chr1")
graph_data <- createGraphFromList(g_list)
edges <- g_list$edges
weights <- g_list$weights
#print(graph_data)
g <- graph.data.frame(graph_data)
#print(g)
edge_weights <- E(g)$w
V(g)$label <- NA
E(g)$label <- NA
layout <- layout_with_fr(g, dim=2)

# Increase the size of the plot
par(mar = c(1, 1, 1, 1))  # Adjust margins if needed
layout <- layout_with_fr(g, dim = 2)

# Set the size of the plot device using the 'width' and 'height' parameters
png("test_graph.png", width = 8000, height = 8000)  # Adjust width and height as needed

# Plot the graph with smaller nodes
plot.igraph(g, layout = layout, vertex.size = .01, vertex.label.dist = 2, edge.alpha = 1)

dev.off()  # Close the plot device
plot.igraph(g, layout = layout, vertex.size = 2, vertex.label.dist = 2, edge.alpha = 0.5)
```

```{r}
g_list <- graphFromFitHIC("data/hic_test.txt", "chr1")
print(length(unique(c(g_list[["to"]], g_list[["from"]]))))
communities <- runLeiden(g_list, 2)
```
